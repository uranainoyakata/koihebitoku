<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‹è›‡ - æœˆä¸‹ã®é–¨</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts for atmosphere -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Custom styles to enhance the theme */
        body {
            font-family: 'Shippori Mincho', serif;
            background-color: #0c143e; 
            background-image: 
                radial-gradient(circle at 15% 15%, rgba(76, 29, 149, 0.3) 0%, transparent 40%),
                radial-gradient(circle at 85% 85%, rgba(29, 78, 216, 0.2) 0%, transparent 50%);
            color: #d1d5db;
        }

        /* Custom animation for pulsating effect */
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 4px 20px rgba(236, 72, 153, 0.3); }
            50% { transform: scale(1.03); box-shadow: 0 6px 30px rgba(236, 72, 153, 0.5); }
            100% { transform: scale(1); box-shadow: 0 4px 20px rgba(236, 72, 153, 0.3); }
        }
        .animate-pulse-custom { animation: pulse 2.5s infinite; }

        /* Card flip animation */
        .card {
            transform-style: preserve-3d;
            transition: transform 0.8s, box-shadow 0.3s;
        }
        .card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 10px 30px rgba(34, 211, 238, 0.3);
        }
        .card.is-flipped { transform: rotateY(180deg); }
        .card-face { backface-visibility: hidden; -webkit-backface-visibility: hidden; }
        .card-back { transform: rotateY(180deg); }
        
        /* Improved Water ripple effect */
        @keyframes ripple {
            from { transform: translate(-50%, -50%) scale(0); opacity: 0.8; }
            to { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }
        .ripple-animation {
            position: absolute; top: 50%; left: 50%; width: 300px; height: 300px;
            border-radius: 50%; 
            border: 2px solid rgba(103, 232, 249, 0.8);
            animation: ripple 1.5s ease-out forwards;
        }

        /* Fade-in animation */
        .fade-in { animation: fadeInAnimation 1.5s ease-in forwards; opacity: 0; }
        @keyframes fadeInAnimation {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Result card animation */
        .result-card-enter {
            opacity: 0; transform: translateY(30px) scale(0.95);
            animation: resultEnter 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
        @keyframes resultEnter { to { opacity: 1; transform: translateY(0) scale(1); } }

        /* Improved Accordion styles for results */
        .result-card { transition: transform 0.5s ease, opacity 0.5s ease; }
        .result-content {
            max-height: 0; overflow: hidden;
            transition: max-height 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94), padding 0.5s ease, border-width 0.5s ease;
            padding-top: 0; padding-bottom: 0; border-top: 0px solid rgba(55, 65, 81, 0.5);
        }
        .result-card.is-open .result-content {
            max-height: 800px; 
            padding-top: 1rem; padding-bottom: 1rem; border-top-width: 1px;
        }
        .result-icon { transition: transform 0.5s ease; }
        .result-card.is-open .result-icon { transform: rotate(180deg); }

        /* Focus mode for results */
        #results-container.is-focused .result-card:not(.is-open) {
            opacity: 0.4; transform: scale(0.95);
        }
        
        /* Class for symbolic icons */
        .symbol-icon {
            font-size: 3.5rem; line-height: 1; 
            color: #374151; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
        }

        /* Shuffle animation styles */
        .deck-card {
            position: absolute; width: 100%; height: 100%;
            background-image: linear-gradient(to bottom right, #1f2937, #111827);
            border: 2px solid rgba(55, 65, 81, 0.8);
            border-radius: 0.5rem; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        @keyframes shuffle-anim-1 { 50% { transform: translate(-80px, -20px) rotate(-15deg); } }
        @keyframes shuffle-anim-2 { 50% { transform: translate(80px, 20px) rotate(15deg); } }
        .shuffling .deck-card:nth-child(1) { animation: shuffle-anim-1 0.5s ease-in-out; }
        .shuffling .deck-card:nth-child(2) { animation: shuffle-anim-2 0.5s ease-in-out; }

        /* Shake animation for error */
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
        .animate-shake {
            animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 overflow-x-hidden">

    <!-- NEW: 0. Password Screen -->
    <div id="password-screen" class="w-full max-w-md text-center">
        <h1 class="text-3xl font-bold text-white mb-4 fade-in" style="text-shadow: 0 0 15px #0ea5e9;">åˆè¨€è‘‰</h1>
        <p class="text-slate-300 mb-8 fade-in" style="animation-delay: 0.3s;">æ‰‰ã‚’é–‹ããŸã‚ã®è¨€è‘‰ã‚’ã€ã“ã“ã¸â€¦</p>
        <div class="mb-4 fade-in" style="animation-delay: 0.6s;">
            <input type="text" id="password-input" class="w-full bg-slate-800/80 border border-slate-600 text-white text-center text-lg p-3 rounded-lg focus:ring-2 focus:ring-cyan-400 focus:outline-none transition-all" placeholder="åˆè¨€è‘‰ã‚’å…¥åŠ›">
        </div>
        <button id="password-button" class="w-full bg-cyan-500 text-slate-900 font-bold py-3 px-10 rounded-lg hover:bg-cyan-400 transition-all duration-300 fade-in" style="animation-delay: 0.9s;">
            æ‰‰ã‚’é–‹ã
        </button>
        <p id="password-error" class="text-pink-400 mt-4 h-6 hidden"></p>
    </div>

    <!-- 1. Splash Screen (now hidden by default) -->
    <div id="splash-screen" class="hidden w-full max-w-md text-center">
        <div class="flex justify-center mb-6 fade-in">
            <img src="https://i.imgur.com/2pjaRY0.jpeg" alt="å ã„å¸« æ‹è›‡" class="w-28 h-28 rounded-full border-2 border-slate-700 shadow-lg" style="box-shadow: 0 0 25px rgba(34, 211, 238, 0.5);">
        </div>
        <h1 class="text-4xl font-bold text-white mb-2 fade-in" style="animation-delay: 0.3s; text-shadow: 0 0 15px #0ea5e9;">æ‹è›‡</h1>
        <p class="text-lg text-slate-300 mb-8 fade-in" style="animation-delay: 0.6s;">æœˆä¸‹ã®é–¨ã¸ã€ã‚ˆã†ã“ã</p>
        <button id="enter-button" class="bg-transparent border-2 border-cyan-400 text-cyan-300 py-3 px-10 rounded-full hover:bg-cyan-400 hover:text-slate-900 transition-all duration-300 fade-in" style="animation-delay: 1.2s;">
            é–¨ã¸å…¥ã‚‹
        </button>
    </div>

    <!-- 2. Ritual Screen -->
    <div id="ritual-screen" class="hidden w-full max-w-md text-center">
        <h2 class="text-2xl text-white mb-4 fade-in">æ°´é¡ã®å„€</h2>
        <p class="text-slate-300 mb-8 fade-in" style="animation-delay: 0.5s;">ã“ã‚Œã‹ã‚‰ä¸‰æšã®æœ­ã‚’å¼•ãã¾ã™<br>ä¸€æšãšã¤ã€å¿ƒã‚’è¾¼ã‚ã¦æ°´é¢ã«ãŠè§¦ã‚Œãã ã•ã„</p>
        <div id="water-mirror" class="relative w-64 h-64 mx-auto bg-slate-900/50 rounded-full border-2 border-cyan-400/50 flex items-center justify-center cursor-pointer overflow-hidden fade-in" style="animation-delay: 1s;">
            <p id="tap-instruction" class="text-cyan-300 text-center text-lg transition-opacity duration-500 z-10 leading-relaxed">ã¾ãšã€éå»ã®è²´æ–¹ã‚’<br>æ°´é¢ã«æ˜ ã—ã¦â€¦</p>
        </div>
    </div>

    <!-- 3. Shuffle Screen -->
    <div id="shuffle-screen" class="hidden w-full max-w-md text-center">
        <h2 class="text-2xl text-white mb-4 fade-in">æµ„åŒ–ã¨ã‚·ãƒ£ãƒƒãƒ•ãƒ«</h2>
        <p class="text-slate-300 mb-8 fade-in" style="animation-delay: 0.5s;">å¿ƒãŒè½ã¡ç€ãã¾ã§ã€ã‚¿ãƒƒãƒ—ã—ã¦<br>ã‚«ãƒ¼ãƒ‰ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã—ã¦ãã ã•ã„</p>
        <div id="deck-container" class="relative w-32 h-48 mx-auto my-10 cursor-pointer">
            <div class="deck-card"></div>
            <div class="deck-card" style="transform: translate(2px, 2px);"></div>
            <div class="deck-card" style="transform: translate(4px, 4px);"></div>
        </div>
        <button id="proceed-button" class="hidden bg-transparent border-2 border-pink-500 text-pink-400 py-3 px-10 rounded-full hover:bg-pink-500 hover:text-white transition-all duration-300">
            æœ­ã‚’é¸ã¶
        </button>
    </div>

    <!-- 4. Card Selection Screen -->
    <div id="selection-screen" class="hidden w-full max-w-md text-center">
        <h2 class="text-2xl text-white mb-4 fade-in">ä¸‰ç€¬å·ã®æœ­</h2>
        <p class="text-slate-300 mb-8 fade-in" style="animation-delay: 0.5s;">éå»ã€ç¾åœ¨ã€æœªæ¥â€¦<br>ç¸ã®ç³¸ã‚’æ‰‹ç¹°ã‚Šå¯„ã›ã‚‹ã‚ˆã†ã«ã€å¿ƒã®ã¾ã¾ã«ä¸€æšãšã¤ãŠå¼•ããã ã•ã„</p>
        <div id="card-container" class="grid grid-cols-3 gap-4 h-56 perspective-[1000px]"></div>
        <p id="card-instruction" class="mt-8 text-cyan-300 h-6"></p>
    </div>

    <!-- 5. Results Screen -->
    <div id="results-screen" class="hidden w-full max-w-md">
        <div class="flex justify-center mb-4 fade-in">
            <img src="https://i.imgur.com/2pjaRY0.jpeg" alt="å ã„å¸« æ‹è›‡" class="w-24 h-24 rounded-full border-2 border-slate-700 shadow-lg" style="box-shadow: 0 0 15px rgba(34, 211, 238, 0.4);">
        </div>
        <h2 class="text-3xl text-center text-white mb-6 fade-in" style="animation-delay: 0.2s; text-shadow: 0 0 10px #0ea5e9;">æ‹è›‡æ§˜ã‹ã‚‰ã®å¾¡ç¥è¨—</h2>
        <div id="results-container" class="space-y-4"></div>
        
        <!-- 6. Final CTA Section -->
        <div id="cta-section" class="mt-12 text-center opacity-0 transition-opacity duration-1000" style="transition-delay: 1s;">
            <div id="reveal-cta-container" class="border-t border-slate-700 pt-6">
                <button id="reveal-cta-button" class="group w-full text-lg font-semibold text-slate-300 p-4 rounded-xl hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2 bg-slate-800/80 border border-slate-600/90 shadow-md hover:border-cyan-400 hover:text-white">
                    <span>ç‰¹åˆ¥ãªå¾¡ç¥è¨—ã¸ã®æ‰‰ã‚’é–‹ã</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 transition-transform duration-300 group-hover:translate-y-0.5"><path d="M12 5v14"/><path d="m19 12-7 7-7-7"/></svg>
                </button>
            </div>
            
            <div id="paid-options-container" class="hidden">
                <div class="border-t border-slate-700 pt-6">
                     <h3 class="text-2xl font-bold text-white my-4" style="text-shadow: 1px 1px 3px #1e293b;">æ‹è›‡ãŒã‚ãªãŸã ã‘ã«åŸ·ã‚Šè¡Œã†ã€å¯†å„€ã€</h3>
                </div>
                
                <div class="my-6">
                    <a href="https://subterra.base.shop/items/112747771" target="_blank" rel="noopener noreferrer" id="special-offer-button" class="block bg-gradient-to-br from-slate-900 to-slate-800 border-2 border-pink-500 rounded-xl p-4 text-decoration-none shadow-lg animate-pulse-custom text-center">
                        <span class="block text-xl font-bold text-pink-400">åˆå›é™å®š ç‰¹åˆ¥é‘‘å®š</span>
                        <span class="block text-lg text-white my-1">é€šå¸¸ä¸‰åƒå†† â†’ <strong class="text-2xl text-pink-400">åƒäº”ç™¾å††</strong></span>
                        <span class="block text-sm text-slate-200 mt-2 font-bold">ï¼ˆPDFé‘‘å®šæ›¸ã«ã¦ç´å“ï¼‰</span>
                        <span class="block text-sm text-slate-400 mt-1">24æ™‚é–“ä»¥å†…ã®ãŠç”³ã—è¾¼ã¿é™å®š</span>
                    </a>
                </div>
    
                <div class="grid gap-4">
                    <a href="https://uranainoyakata.github.io/koihebikutikomi/" target="_blank" rel="noopener noreferrer" class="block bg-slate-800/80 border border-slate-700 rounded-lg py-3 text-decoration-none text-slate-300 text-lg hover:bg-slate-700 hover:border-cyan-500 transition-colors">
                        å¯„ã›ã‚‰ã‚ŒãŸå£°ã‚’è¦‹ã‚‹ï¼ˆå£ã‚³ãƒŸï¼‰
                    </a>
                    <a href="#menu" class="block bg-slate-800/80 border border-slate-700 rounded-lg py-3 text-decoration-none text-slate-300 text-lg hover:bg-slate-700 hover:border-cyan-500 transition-colors">
                        å…¨ã¦ã®å¯†å„€ã‚’è¦‹ã‚‹ï¼ˆé‘‘å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰
                    </a>
                    <a href="https://lin.ee/DPDaa9V" target="_blank" rel="noopener noreferrer" class="block bg-slate-800/80 border border-slate-700 rounded-lg py-3 text-decoration-none text-slate-300 text-lg hover:bg-slate-700 hover:border-cyan-500 transition-colors">
                        æ‹è›‡ã«ç›´æ¥ç›¸è«‡ã™ã‚‹
                    </a>
                </div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- DOM Elements ---
    const screens = {
        password: document.getElementById('password-screen'), // NEW
        splash: document.getElementById('splash-screen'),
        ritual: document.getElementById('ritual-screen'),
        shuffle: document.getElementById('shuffle-screen'),
        selection: document.getElementById('selection-screen'),
        results: document.getElementById('results-screen'),
    };
    const passwordInput = document.getElementById('password-input'); // NEW
    const passwordButton = document.getElementById('password-button'); // NEW
    const passwordError = document.getElementById('password-error'); // NEW
    const enterButton = document.getElementById('enter-button');
    const waterMirror = document.getElementById('water-mirror');
    const tapInstruction = document.getElementById('tap-instruction');
    const deckContainer = document.getElementById('deck-container');
    const proceedButton = document.getElementById('proceed-button');
    const cardContainer = document.getElementById('card-container');
    const cardInstruction = document.getElementById('card-instruction');
    const resultsContainer = document.getElementById('results-container');
    const ctaSection = document.getElementById('cta-section');
    const revealCtaButton = document.getElementById('reveal-cta-button'); 
    const paidOptionsContainer = document.getElementById('paid-options-container'); 

    // --- Tarot Card Data (Detailed content) ---
    const tarotData = [
        { 
            name: 'é­”è¡“å¸«', icon: 'âˆ',
            interpretation: 'è²´æ–¹ã®æ‹ã¯ä»Šã€æ–°ãŸãªå¯èƒ½æ€§ã«æº€ã¡ã¦ã„ã¾ã™ã€‚è¨€è‘‰ã‚„è¡Œå‹•ä¸€ã¤ã§ã€ç›¸æ‰‹ã®å¿ƒã‚’å‹•ã‹ã™åŠ›ã‚’ç§˜ã‚ã¦ã„ã‚‹æ™‚ã€‚ã—ã‹ã—ã€ãã®åŠ›ã¯æœªã å½¢ã«ãªã£ã¦ã„ã¾ã›ã‚“ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã¯è²´æ–¹ã®å¤šæ‰ãªé­…åŠ›ã«æ°—ã¥ãå§‹ã‚ã¦ã„ã¾ã™ãŒã€ã¾ã ç¢ºä¿¡ã«ã¯è‡³ã£ã¦ã„ãªã„æ§˜å­ã€‚è²´æ–¹ã®æ¬¡ã®ä¸€æ‰‹ã‚’èˆˆå‘³æ·±ãè¦‹å®ˆã£ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã€‚',
            advice: 'ä»Šã¯å¾…ã¤æ™‚ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å°ã•ãªä¸€æ­©ã§ã‚‚è‰¯ã„ã®ã§ã€è‡ªã‚‰è¡Œå‹•ã‚’èµ·ã“ã—ã¾ã—ã‚‡ã†ã€‚å¾—æ„ãªã“ã¨ã§ã‚¢ãƒ”ãƒ¼ãƒ«ã™ã‚‹ã€ä¼šè©±ã®ãã£ã‹ã‘ã‚’ä½œã‚‹ãªã©ã€è²´æ–¹ã®å‰µé€ æ€§ãŒéµã¨ãªã‚Šã¾ã™ã€‚',
        },
        { 
            name: 'å¥³æ•™çš‡', icon: 'â˜¾',
            interpretation: 'é™å¯‚ã®ä¸­ã«çœŸå®ŸãŒéš ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»Šã¯æ„Ÿæƒ…çš„ã«å‹•ãã‚ˆã‚Šã‚‚ã€å†·é™ã«çŠ¶æ³ã‚’è¦‹ã¤ã‚ã€è‡ªèº«ã®å†…ãªã‚‹å£°ã«è€³ã‚’å‚¾ã‘ã‚‹ã¹ãæ™‚ã€‚è¦‹ãˆã¦ã„ãªã‹ã£ãŸç­”ãˆãŒã€ãµã¨å¿ƒã«æµ®ã‹ã¶ã§ã—ã‚‡ã†ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã¯è²´æ–¹ã®è½ã¡ç€ã„ãŸã€å°‘ã—ãƒŸã‚¹ãƒ†ãƒªã‚¢ã‚¹ãªéƒ¨åˆ†ã«æƒ¹ã‹ã‚Œã¦ã„ã¾ã™ã€‚å¤šãã‚’èªã‚‰ãšã¨ã‚‚ã€ãã®çŸ¥çš„ãªé›°å›²æ°—ãŒèˆˆå‘³ã‚’æ»ãç«‹ã¦ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚',
            advice: 'ç„¦ã‚Šã¯ç¦ç‰©ã§ã™ã€‚ä»Šã¯ç„¡ç†ã«è·é›¢ã‚’ç¸®ã‚ã‚ˆã†ã¨ã›ãšã€èãå½¹ã«å¾¹ã—ãŸã‚Šã€é™ã‹ã«å¯„ã‚Šæ·»ã£ãŸã‚Šã™ã‚‹ã“ã¨ã§ã€ä¿¡é ¼ãŒæ·±ã¾ã‚Šã¾ã™ã€‚è²´æ–¹ã®æ´å¯ŸåŠ›ãŒã€äºŒäººã®é–¢ä¿‚ã‚’æ­£ã—ã„æ–¹å‘ã¸å°ãã¾ã™ã€‚',
        },
        { 
            name: 'æ‹äººãŸã¡', icon: 'â™Š',
            interpretation: 'å¿ƒãŒé€šã„åˆã†ã€è‡³ç¦ã®æ™‚ã€‚ã“ã®æ‹ã¯è²´æ–¹ã«ã¨ã£ã¦ã€äººç”Ÿã‚’å½©ã‚‹å¤§ããªå–œã³ã¨ãªã‚‹ã§ã—ã‚‡ã†ã€‚ãŠäº’ã„ãŒè‡ªç„¶ä½“ã§ã„ã‚‰ã‚Œã‚‹é–¢ä¿‚ãŒã€ä»Šã¾ã•ã«å§‹ã¾ã‚ã†ã¨ã—ã¦ã„ã¾ã™ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã‚‚ã¾ãŸã€è²´æ–¹ã¨å…±ã«ã„ã‚‹æ™‚é–“ã«å¿ƒåœ°ã‚ˆã•ã‚’æ„Ÿã˜ã¦ã„ã¾ã™ã€‚ä¼šè©±ãŒå¼¾ã¿ã€ä¸€ç·’ã«ã„ã‚‹ã ã‘ã§æ¥½ã—ã„â€¦ãã‚“ãªç´”ç²‹ãªå¥½æ„ã‚’æŠ±ã„ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã—ã‚‡ã†ã€‚',
            advice: 'é¸æŠã®æ™‚ã§ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã®å¿ƒåœ°ã‚ˆã„é–¢ä¿‚ã‚’ã€ä¸€æ­©å…ˆã¸é€²ã‚ã‚‹è¦šæ‚Ÿã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿè‡ªåˆ†ã®å¿ƒã«æ­£ç›´ã«ãªã‚Šã€ç´ ç›´ãªæ°—æŒã¡ã‚’ä¼ãˆã‚‹ã“ã¨ã§ã€é‹å‘½ã¯å¤§ããå‹•ãå‡ºã—ã¾ã™ã€‚',
        },
        { 
            name: 'é‹å‘½ã®è¼ª', icon: 'â˜¸',
            interpretation: 'æŠ—ãˆãªã„é‹å‘½ã®åŠ›ãŒã€äºŒäººã®é–¢ä¿‚ã«ä½œç”¨ã—ã¦ã„ã¾ã™ã€‚ãã‚Œã¯çªç„¶ã®ãƒãƒ£ãƒ³ã‚¹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã—ã€é¿ã‘ã¦ã¯é€šã‚Œãªã„è©¦ç·´ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã„ãšã‚Œã«ã›ã‚ˆã€ç‰©èªãŒå¤§ããå‹•ãå‡ºã™å‰å…†ã§ã™ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã‚‚ã¾ãŸã€è²´æ–¹ã¨ã®é–“ã«ä½•ã‹ç‰¹åˆ¥ãªã€Œç¸ã€ã‚’æ„Ÿã˜å§‹ã‚ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å¶ç„¶ã®å‡ºæ¥äº‹ãŒé‡ãªã‚Šã€é‹å‘½çš„ãªå­˜åœ¨ã¨ã—ã¦æ„è­˜ã—å§‹ã‚ã¦ã„ã‚‹æ®µéšã§ã™ã€‚',
            advice: 'æµã‚Œã«èº«ã‚’ä»»ã›ã‚‹å‹‡æ°—ã‚’æŒã¡ã¾ã—ã‚‡ã†ã€‚è‰¯ã„ã“ã¨ã‚‚æ‚ªã„ã“ã¨ã‚‚ã€å…¨ã¦ã¯æœªæ¥ã¸ã®å¸ƒçŸ³ã§ã™ã€‚å¤‰åŒ–ã‚’æã‚Œãšã€ç›®ã®å‰ã§èµ·ã“ã‚‹å‡ºæ¥äº‹ã‚’ç´ ç›´ã«å—ã‘æ­¢ã‚ã‚‹ã“ã¨ãŒã€å¹¸é‹ã‚’æ´ã‚€éµã¨ãªã‚Šã¾ã™ã€‚',
        },
        { 
            name: 'å¡”', icon: 'âš¡',
            interpretation: 'è¡æ’ƒçš„ãªå‡ºæ¥äº‹ã«ã‚ˆã‚Šã€ã“ã‚Œã¾ã§ã®é–¢ä¿‚ã‚„ä¾¡å€¤è¦³ãŒå¤§ããæºã‚‰ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ã“ã‚Œã¯ç ´å£Šã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å½ã‚Šã®ä¸Šã«ç¯‰ã‹ã‚ŒãŸã‚‚ã®ã‚’æµ„åŒ–ã—ã€çœŸå®Ÿã®é–¢ä¿‚ã‚’ç¯‰ããŸã‚ã®å¤©ã®é‡‡é…ã§ã™ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã‚‚ã¾ãŸã€ã“ã®é–¢ä¿‚ã«ä½•ã‚‰ã‹ã®é•å’Œæ„Ÿã‚„é™ç•Œã‚’æ„Ÿã˜ã¦ã„ãŸå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å‡ºæ¥äº‹ã‚’ãã£ã‹ã‘ã«ã€æœ¬éŸ³ã§å‘ãåˆã„ãŸã„ã¨ã„ã†æ°—æŒã¡ãŒèŠ½ç”Ÿãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚',
            advice: 'ç—›ã¿ã‚’ä¼´ã„ã¾ã™ãŒã€ã“ã“ã§ç›®ã‚’èƒŒã‘ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚å´©ã‚Œå»ã£ãŸã‚‚ã®ã®ä¸­ã‹ã‚‰ã€æœ¬å½“ã«å¤§åˆ‡ã ã£ãŸã‚‚ã®ãŒè¦‹ãˆã¦ãã‚‹ã¯ãšã€‚é›¨é™ã£ã¦åœ°å›ºã¾ã‚‹ã€ãã®è¨€è‘‰ã‚’ä¿¡ã˜ã¦ãã ã•ã„ã€‚',
        },
        { 
            name: 'æ˜Ÿ', icon: 'âœ¶',
            interpretation: 'å‚·ã¤ã„ãŸå¿ƒãŒç™’ã•ã‚Œã€ç´”ç²‹ãªå¸Œæœ›ã®å…‰ãŒè¦‹ãˆã¦ãã‚‹æ™‚ã€‚éå»ã®è¾›ã„æ‹ã®çµŒé¨“ã‚‚ã€ä»Šã®è²´æ–¹ã‚’è¼ã‹ã›ã‚‹ãŸã‚ã®ç³§ã¨ãªã‚Šã¾ã™ã€‚ç†æƒ³ã®æ‹ã‚’è«¦ã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã¯è²´æ–¹ã®ç´”ç²‹ã•ã‚„ã€ã²ãŸã‚€ããªå§¿ã«å¿ƒã‚’æ‰“ãŸã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚å®ˆã£ã¦ã‚ã’ãŸã„ã€åŠ›ã«ãªã‚ŠãŸã„ã¨ã„ã†æ¸…ã‚‰ã‹ãªæ„›æƒ…ãŒèŠ½ç”Ÿãˆã¦ã„ã¾ã™ã€‚',
            advice: 'è‡ªåˆ†ã‚’å½ã‚‰ãšã€ã‚ã‚Šã®ã¾ã¾ã®å§¿ã§ã„ã‚‹ã“ã¨ãŒä½•ã‚ˆã‚Šã‚‚å¤§åˆ‡ã§ã™ã€‚é£¾ã‚‰ãªã„è¨€è‘‰ã‚„ç¬‘é¡”ãŒã€ãŠç›¸æ‰‹ã®å¿ƒã«æœ€ã‚‚å¼·ãéŸ¿ãã¾ã™ã€‚æœªæ¥ã¸ã®é¡˜ã„ã‚’ã€ãã£ã¨æ‰“ã¡æ˜ã‘ã¦ã¿ã‚‹ã®ã‚‚è‰¯ã„ã§ã—ã‚‡ã†ã€‚',
        },
        { 
            name: 'æœˆ', icon: 'ğŸŒ•',
            interpretation: 'ä¸å®‰ã‚„è¿·ã„ãŒã€éœ§ã®ã‚ˆã†ã«å¿ƒã‚’è¦†ã£ã¦ã„ã¾ã™ã€‚ãŠç›¸æ‰‹ã®æœ¬å½“ã®æ°—æŒã¡ãŒè¦‹ãˆãšã€ç–‘å¿ƒæš—é¬¼ã«é™¥ã‚Šã‚„ã™ã„æ™‚æœŸã€‚ã—ã‹ã—ã€è¦‹ãˆãªã„ã®ã¯è²´æ–¹ã®å¿ƒã‚‚åŒã˜ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã‚‚ã¾ãŸã€è²´æ–¹ã®æ°—æŒã¡ã‚’æ¸¬ã‚Šã‹ã­ã¦ã€ã©ã†æ¥ã™ã‚Œã°è‰¯ã„ã‹è¿·ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãŠäº’ã„ã«æœ¬éŸ³ã‚’éš ã—ãŸã¾ã¾ã€æ¢ã‚Šåˆã„ã®çŠ¶æ…‹ãŒç¶šã„ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚',
            advice: 'ä»Šã¯ç„¦ã£ã¦ç­”ãˆã‚’å‡ºã™æ™‚ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚æ›–æ˜§ãªçŠ¶æ³ã‚’ç„¡ç†ã«æ™´ã‚‰ãã†ã¨ã™ã‚‹ã¨ã€ã‹ãˆã£ã¦é–¢ä¿‚ãŒã“ã˜ã‚Œã¦ã—ã¾ã†æã‚ŒãŒã€‚æœˆãŒæº€ã¡æ¬ ã‘ã™ã‚‹ã‚ˆã†ã«ã€æ™‚ãŒçµŒã¦ã°çœŸå®Ÿã¯è‡ªãšã¨æ˜ã‚‰ã‹ã«ãªã‚Šã¾ã™ã€‚',
        },
        { 
            name: 'å¤ªé™½', icon: 'â˜‰',
            interpretation: 'å…¨ã¦ã®è¿·ã„ãŒæ™´ã‚Œã€ç¥ç¦ã®å…‰ãŒäºŒäººã‚’ç…§ã‚‰ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œä»¥ä¸Šãªã„ã»ã©ã®å¹¸ç¦æ„Ÿã¨å–œã³ã«æº€ã¡ãŸã€ç´ æ™´ã‚‰ã—ã„é–¢ä¿‚ã®åˆ°æ¥ã§ã™ã€‚æœªæ¥ã¯æ˜ã‚‹ãã€å¸Œæœ›ã«æº€ã¡ã¦ã„ã¾ã™ã€‚',
            partner_feeling: 'ãŠç›¸æ‰‹ã¯è²´æ–¹ã¨ã®é–¢ä¿‚ã«ã€ä¸€ç‚¹ã®æ›‡ã‚Šã‚‚ãªã„å–œã³ã¨ç¢ºä¿¡ã‚’æŠ±ã„ã¦ã„ã¾ã™ã€‚è²´æ–¹ã®å­˜åœ¨ãã®ã‚‚ã®ãŒã€å½¼/å½¼å¥³ã«ã¨ã£ã¦ã®å¤ªé™½ãªã®ã§ã™ã€‚',
            advice: 'ã“ã®å¹¸ã›ã‚’ã€éš ã™ã“ã¨ãªãç´ ç›´ã«è¡¨ç¾ã—ã¾ã—ã‚‡ã†ã€‚æ„Ÿè¬ã®è¨€è‘‰ã‚’ä¼ãˆã€å…±ã«ç¬‘ã„åˆã†æ™‚é–“ã‚’æŒã¤ã“ã¨ã§ã€äºŒäººã®çµ†ã¯ã‚ˆã‚Šä¸€å±¤ã€å¼·ãå›ºãçµã°ã‚Œã¦ã„ãã¾ã™ã€‚',
        }
    ];

    let drawnCards = [];
    let cardsToDraw = ['éå»', 'ç¾åœ¨', 'æœªæ¥'];
    
    const ritualMessages = [
        'æ¬¡ã«ã€ç¾åœ¨ã®æƒ³ã„ã‚’<br>æ°´é¢ã«æº¶ã‹ã—ã¦â€¦',
        'æœ€å¾Œã«ã€æœ›ã‚€æœªæ¥ã‚’<br>æ°´é¢ã«æã„ã¦â€¦',
        'â€¦é¡˜ã„ã¯ã€å±Šãã¾ã—ãŸ'
    ];
    let ritualStep = 0;
    let isShuffling = false;

    // --- Functions ---
    const switchScreen = (screenName) => {
        Object.values(screens).forEach(screen => screen.classList.add('hidden'));
        if (screens[screenName]) {
            screens[screenName].classList.remove('hidden');
        }
    };

    const setupCardSelection = () => {
        cardContainer.innerHTML = '';
        drawnCards = [];
        cardsToDraw = ['éå»', 'ç¾åœ¨', 'æœªæ¥'];
        const shuffledDeck = [...tarotData].sort(() => 0.5 - Math.random());
        
        for (let i = 0; i < 3; i++) {
            const cardData = shuffledDeck[i];
            const cardEl = document.createElement('div');
            cardEl.className = 'card w-full h-full cursor-pointer';
            Object.keys(cardData).forEach(key => {
                cardEl.dataset[key] = cardData[key];
            });

            cardEl.innerHTML = `
                <div class="card-face card-front w-full h-full bg-gradient-to-br from-slate-900 via-indigo-900 to-slate-900 border-2 border-cyan-500/60 rounded-lg flex items-center justify-center p-2 flex-col shadow-lg backdrop-blur-sm relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-full h-full bg-black/20"></div>
                    <div class="text-5xl opacity-80 text-cyan-200" style="text-shadow: 0 0 10px #fff;">ğŸ</div>
                    <div class="text-cyan-200 mt-2 text-sm tracking-widest">æ‹è›‡ç¥è¨—</div>
                    <div class="absolute bottom-2 right-2 text-cyan-400/50 text-xs">â—†</div>
                    <div class="absolute top-2 left-2 text-cyan-400/50 text-xs">â—†</div>
                </div>
                <div class="card-face card-back w-full h-full bg-white border-2 border-cyan-400 rounded-lg flex items-center justify-center p-2 flex-col shadow-2xl">
                    <div class="symbol-icon">${cardData.icon}</div>
                    <div class="text-gray-700 font-bold text-lg mt-2">${cardData.name}</div>
                </div>
            `;
            cardContainer.appendChild(cardEl);
            cardEl.addEventListener('click', () => flipCard(cardEl));
        }
        updateInstruction();
    };
    
    const updateInstruction = () => {
        if (cardsToDraw.length > 0) {
            cardInstruction.textContent = `ã€Œ${cardsToDraw[0]}ã€ã®æœ­ã‚’ãŠå¼•ããã ã•ã„`;
        } else {
            cardInstruction.textContent = '';
        }
    };

    const flipCard = (cardEl) => {
        if (cardEl.classList.contains('is-flipped') || cardsToDraw.length === 0) return;
        
        cardEl.classList.add('is-flipped');
        const cardInfo = { ...cardEl.dataset };
        cardInfo.position = cardsToDraw.shift();
        drawnCards.push(cardInfo);
        updateInstruction();

        if (cardsToDraw.length === 0) {
            setTimeout(showResults, 2000);
        }
    };

    const showResults = () => {
        resultsContainer.innerHTML = '';
        drawnCards.forEach((card, index) => {
            const resultEl = document.createElement('div');
            resultEl.className = 'result-card result-card-enter bg-slate-800/70 border border-slate-700/50 rounded-xl shadow-lg backdrop-blur-sm overflow-hidden';
            resultEl.style.animationDelay = `${(index * 0.2) + 0.3}s`;
            resultEl.innerHTML = `
                <div class="result-header p-4 flex justify-between items-center cursor-pointer">
                    <div class="flex items-center">
                        <div class="text-4xl mr-4 text-cyan-300">${card.icon}</div>
                        <div>
                            <p class="text-cyan-400 text-sm">${card.position}</p>
                            <h3 class="text-xl font-bold text-white">${card.name}</h3>
                        </div>
                    </div>
                    <div class="result-icon text-2xl text-cyan-300">â–¼</div>
                </div>
                <div class="result-content px-4">
                    <div class="pt-4 border-t border-slate-700 space-y-5">
                        <div>
                            <h4 class="font-bold text-cyan-400 mb-2">ç¾çŠ¶ã®è§£é‡ˆ</h4>
                            <p class="text-slate-300 leading-relaxed text-base">${card.interpretation}</p>
                        </div>
                        <div>
                            <h4 class="font-bold text-cyan-400 mb-2">ãŠç›¸æ‰‹ã®æ°—æŒã¡</h4>
                            <p class="text-slate-300 leading-relaxed text-base">${card.partner_feeling}</p>
                        </div>
                        <div>
                            <h4 class="font-bold text-pink-400 mb-2">æ‹è›‡ã‹ã‚‰ã®åŠ©è¨€</h4>
                            <p class="text-slate-300 leading-relaxed text-base">${card.advice}</p>
                        </div>
                    </div>
                </div>
            `;
            resultsContainer.appendChild(resultEl);
        });
        
        document.querySelectorAll('.result-header').forEach(header => {
            header.addEventListener('click', () => {
                const currentCard = header.parentElement;
                const wasOpen = currentCard.classList.contains('is-open');
                document.querySelectorAll('.result-card').forEach(card => card.classList.remove('is-open'));
                if (!wasOpen) {
                    currentCard.classList.add('is-open');
                    resultsContainer.classList.add('is-focused');
                } else {
                    resultsContainer.classList.remove('is-focused');
                }
            });
        });

        switchScreen('results');
        
        setTimeout(() => {
            ctaSection.classList.remove('opacity-0');
        }, drawnCards.length * 200 + 800);
    };

    // --- Event Listeners ---
    passwordButton.addEventListener('click', () => {
        const secretWord = 'æ‰‰ã‚’é–‹ã';
        if (passwordInput.value.trim() === secretWord) {
            passwordError.classList.add('hidden');
            screens.password.classList.add('opacity-0', 'transition-opacity', 'duration-700');
            setTimeout(() => {
                switchScreen('splash');
            }, 700);
        } else {
            passwordError.textContent = 'åˆè¨€è‘‰ãŒé•ã„ã¾ã™â€¦';
            passwordError.classList.remove('hidden');
            screens.password.classList.add('animate-shake');
            setTimeout(() => {
                screens.password.classList.remove('animate-shake');
            }, 500);
        }
    });

    passwordInput.addEventListener('keypress', (event) => {
        if (event.key === 'Enter') {
            passwordButton.click();
        }
    });

    enterButton.addEventListener('click', () => {
        ritualStep = 0;
        tapInstruction.innerHTML = 'ã¾ãšã€éå»ã®è²´æ–¹ã‚’<br>æ°´é¢ã«æ˜ ã—ã¦â€¦';
        tapInstruction.classList.remove('opacity-0');
        screens.splash.classList.add('opacity-0', 'transition-opacity', 'duration-700');
        setTimeout(() => { switchScreen('ritual'); }, 700);
    });

    waterMirror.addEventListener('click', () => {
        if (ritualStep >= ritualMessages.length) return;
        const rippleEl = document.createElement('div');
        rippleEl.className = 'ripple-animation';
        waterMirror.appendChild(rippleEl);
        rippleEl.addEventListener('animationend', () => rippleEl.remove());

        tapInstruction.classList.add('opacity-0');
        setTimeout(() => {
            tapInstruction.innerHTML = ritualMessages[ritualStep];
            tapInstruction.classList.remove('opacity-0');
            ritualStep++;
        }, 500);

        if (ritualStep === ritualMessages.length - 1) {
            setTimeout(() => {
                screens.ritual.classList.add('opacity-0', 'transition-opacity', 'duration-700');
            }, 2500); 
            setTimeout(() => {
                proceedButton.classList.add('hidden');
                switchScreen('shuffle');
            }, 3200);
        }
    });

    deckContainer.addEventListener('click', () => {
        if (isShuffling) return;
        isShuffling = true;
        deckContainer.classList.add('shuffling');

        if (proceedButton.classList.contains('hidden')) {
            setTimeout(() => {
                proceedButton.classList.remove('hidden');
                proceedButton.classList.add('fade-in');
            }, 300);
        }

        setTimeout(() => {
            deckContainer.classList.remove('shuffling');
            isShuffling = false;
        }, 500);
    });
    
    proceedButton.addEventListener('click', () => {
        screens.shuffle.classList.add('opacity-0', 'transition-opacity', 'duration-700');
        setTimeout(() => {
            setupCardSelection();
            switchScreen('selection');
        }, 700);
    });

    revealCtaButton.addEventListener('click', () => {
        revealCtaButton.parentElement.classList.add('hidden');
        paidOptionsContainer.classList.remove('hidden');
        paidOptionsContainer.classList.add('fade-in');
    });
    
    // Initial setup
    switchScreen('password');
});
</script>

</body>
</html>

